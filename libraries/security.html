<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Seguridad &mdash; documentación de Higgs - 7.0.2</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=67a8c293" />
      <link rel="stylesheet" type="text/css" href="../_static/css/citheme.css?v=d9728d44" />

  
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="canonical" href="https://higgs.com.co/libraries/security.html" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=e20d7d46"></script>
        <script src="../_static/doctools.js?v=888ff710"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../_static/translations.js?v=efdbd0b9"></script>
        <script src="../_static/js/citheme.js?v=e0bcfc84"></script>
        <script src="../_static/js/carbon.js?v=693e881e"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Biblioteca de sesiones" href="sessions.html" />
    <link rel="prev" title="Editor" href="publisher.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
              <img src="../_static/logo.svg" class="logo" alt="Logotipo"/>
          </a>
              <div class="version">
                7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Bienvenido a Higgs (AI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/hmvc.html">HMVC (Hierarchical Model-View-Controller)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">Cumplimiento de PSR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">Acuerdo de licencia</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Instalación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Compositor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">Instalación manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">Ejecutando su aplicación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">Solución de problemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelogs/index.html">Registro de Cambios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">Actualizaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">Repositorios</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Cree su primera aplicación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">Páginas estáticas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">Sección de noticias</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">Crear noticias</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">Conclusión</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Descripción general del Higgs (AI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/structure.html">Application Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/mvc.html">Modelos, vistas y controladores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/autoloader.html">Archivos de carga automática</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/services.html">Servicios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/factories.html">Fábricas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/http.html">Trabajar con solicitudes HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/security.html">Pautas de seguridad</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">Temas generales</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">Configuración en Higgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">URL de Higgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">Funciones auxiliares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">Funciones y constantes globales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">Información de registro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">Almacenamiento en caché de páginas web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">Solicitudes AJAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">Módulos de código</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">Administrar sus aplicaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">Manejo de múltiples entornos</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../incoming/index.html">Controllers and Routing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../incoming/routing.html">Enrutamiento URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/controllers.html">Controladores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/filters.html">Filtros del controlador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/message.html">Mensajes HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/request.html">Solicitar clase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/incomingrequest.html">IncomingRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/content_negotiation.html">Content Negotiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/methodspoofing.html">Suplantación de método HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/restful.html">Manejo de recursos RESTful</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">Construyendo respuestas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">Puntos de vista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">Ver celdas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">Ver renderizador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">Ver diseños</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">Ver analizador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_decorators.html">Ver decoradores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">Clase de tabla HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">Rasgo de respuesta API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/csp.html">Política de seguridad de contenidos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">Localización</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">Sintaxis PHP alternativa para ver archivos</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">Trabajar con bases de datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/examples.html">Inicio rápido: ejemplos de uso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/configuration.html">Configuración de base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/connecting.html">Conexión a una base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/queries.html">Ejecución de consultas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/results.html">Generando resultados de consulta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/helpers.html">Funciones auxiliares de consulta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/query_builder.html">Clase de generador de consultas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/transactions.html">Actas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/metadata.html">Obtener metadatos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/call_function.html">Llamadas a funciones personalizadas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/events.html">Eventos de base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/utilities.html">Utilidades de base de datos</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Datos de modelado</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">Usando el modelo de Higgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">Usando clases de entidad</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">Administrar bases de datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">Manipulación de bases de datos con Database Forge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">Migraciones de bases de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">Siembra de base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/db_commands.html">Comandos de base de datos</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Referencia de la biblioteca</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="caching.html">Controlador de almacenamiento en caché</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookies.html">Galletas</a></li>
<li class="toctree-l2"><a class="reference internal" href="curlrequest.html">Clase de solicitud CURL</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Clase de correo electrónico</a></li>
<li class="toctree-l2"><a class="reference internal" href="encryption.html">Servicio de cifrado</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Trabajar con archivos</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_collections.html">Colecciones de archivos</a></li>
<li class="toctree-l2"><a class="reference internal" href="honeypot.html">clase de miel</a></li>
<li class="toctree-l2"><a class="reference internal" href="images.html">Clase de manipulación de imágenes</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Paginación</a></li>
<li class="toctree-l2"><a class="reference internal" href="publisher.html">Editor</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Seguridad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Biblioteca de sesiones</a></li>
<li class="toctree-l2"><a class="reference internal" href="throttler.html">acelerador</a></li>
<li class="toctree-l2"><a class="reference internal" href="time.html">Horarios y fechas</a></li>
<li class="toctree-l2"><a class="reference internal" href="typography.html">Tipografía</a></li>
<li class="toctree-l2"><a class="reference internal" href="uploaded_files.html">Trabajar con archivos cargados</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html">Creando instancias de URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#cadenas-uri">Cadenas URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#las-partes-de-uri">Las partes de URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#segmentos-uri">Segmentos URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#deshabilitar-el-lanzamiento-de-excepciones">Deshabilitar el lanzamiento de excepciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_agent.html">Clase de agente de usuario</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html">Validation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Ayudantes</a><ul class="simple">
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Pruebas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">Generating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">Controller Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">Respuestas de prueba</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">Mocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">Evaluación comparativa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">Depurando su aplicación</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Uso de la línea de comando</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_overview.html">Descripción general de la CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_controllers.html">Ejecución de controladores a través de CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/spark_commands.html">Comandos de chispa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">Crear comandos Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">Generadores CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">CLI Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">Clase de solicitud CLI</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">Higgs extendido</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">Crear clases de sistema central</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">Reemplazo de funciones comunes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">Eventos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">Ampliación del controlador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">Autenticación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/composer_packages.html">Crear paquetes de compositor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">Contribuyendo al Higgs</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="official_packages.html">Paquetes Oficiales</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Higgs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Referencia de la biblioteca</a></li>
      <li class="breadcrumb-item active">Seguridad</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="seguridad">
<h1>Seguridad<a class="headerlink" href="#seguridad" title="Link to this heading"></a></h1>
<p>La clase de seguridad contiene métodos que ayudan a proteger su sitio contra ataques de falsificación de solicitudes entre sitios.</p>
<nav class="contents local" id="contenido">
<ul class="simple">
<li><p><a class="reference internal" href="#cargando-la-biblioteca" id="id1">Cargando la biblioteca</a></p></li>
<li><p><a class="reference internal" href="#falsificacion-de-solicitudes-entre-sitios-csrf" id="id2">Falsificación de solicitudes entre sitios (CSRF)</a></p>
<ul>
<li><p><a class="reference internal" href="#requisito-previo" id="id3">Requisito previo</a></p>
<ul>
<li><p><a class="reference internal" href="#cuando-el-enrutamiento-automatico-esta-deshabilitado" id="id4">Cuando el enrutamiento automático está deshabilitado</a></p></li>
<li><p><a class="reference internal" href="#cuando-el-enrutamiento-automatico-esta-habilitado" id="id5">Cuando el enrutamiento automático está habilitado</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#configuracion-para-csrf" id="id6">Configuración para CSRF</a></p>
<ul>
<li><p><a class="reference internal" href="#metodos-de-proteccion-csrf" id="id7">Métodos de protección CSRF</a></p></li>
<li><p><a class="reference internal" href="#aleatorizacion-de-tokens" id="id8">Aleatorización de tokens</a></p></li>
<li><p><a class="reference internal" href="#regeneracion-de-tokens" id="id9">Regeneración de tokens</a></p></li>
<li><p><a class="reference internal" href="#redireccion-en-caso-de-error" id="id10">Redirección en caso de error</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#habilitar-la-proteccion-csrf" id="id11">Habilitar la protección CSRF</a></p></li>
<li><p><a class="reference internal" href="#formularios-html" id="id12">Formularios HTML</a></p></li>
<li><p><a class="reference internal" href="#el-orden-de-los-tokens-enviados-por-los-usuarios" id="id13">El orden de los tokens enviados por los usuarios</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#otros-metodos-utiles" id="id14">Otros métodos útiles</a></p>
<ul>
<li><p><a class="reference internal" href="#desinfectar-nombre-de-archivo" id="id15">desinfectar nombre de archivo()</a></p></li>
</ul>
</li>
</ul>
</nav>
<section id="cargando-la-biblioteca">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Cargando la biblioteca</a><a class="headerlink" href="#cargando-la-biblioteca" title="Link to this heading"></a></h2>
<p>Si su único interés al cargar la biblioteca es manejar la protección CSRF, entonces nunca necesitará cargarla.
ya que se ejecuta como un filtro y no tiene interacción manual.</p>
<p>Sin embargo, si encuentra un caso en el que necesita acceso directo, puede cargarlo a través del archivo de Servicios:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$security</span> <span class="o">=</span> <span class="nx">\Config\Services</span><span class="o">::</span><span class="na">security</span><span class="p">();</span>
</pre></div>
</div>
</section>
<section id="falsificacion-de-solicitudes-entre-sitios-csrf">
<span id="cross-site-request-forgery"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink">Falsificación de solicitudes entre sitios (CSRF)</a><a class="headerlink" href="#falsificacion-de-solicitudes-entre-sitios-csrf" title="Link to this heading"></a></h2>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>The CSRF Protection is only available for <strong>POST/PUT/PATCH/DELETE</strong> requests.
Las solicitudes de otros métodos no están protegidas.</p>
</div>
<section id="requisito-previo">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">Requisito previo</a><a class="headerlink" href="#requisito-previo" title="Link to this heading"></a></h3>
<p>Cuando utiliza la protección CSRF de Higgs, aún necesita codificar de la siguiente manera.
De lo contrario, es posible que se omita la protección CSRF.</p>
<section id="cuando-el-enrutamiento-automatico-esta-deshabilitado">
<h4><a class="toc-backref" href="#id4" role="doc-backlink">Cuando el enrutamiento automático está deshabilitado</a><a class="headerlink" href="#cuando-el-enrutamiento-automatico-esta-deshabilitado" title="Link to this heading"></a></h4>
<p>Haz una de las siguientes:</p>
<ol class="arabic simple">
<li><p>No utilice <code class="docutils literal notranslate"><span class="pre">$routes-&gt;add()</span></code> y utilice verbos HTTP en las rutas.</p></li>
<li><p>Verifique el método de solicitud en el método del controlador antes de procesarlo.</p></li>
</ol>
<p>P.ej:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">solicitud</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;publicación&#39;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">respuesta</span><span class="o">-&gt;</span><span class="na">setStatusCode</span><span class="p">(</span><span class="mi">405</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setBody</span><span class="p">(</span><span class="s1">&#39;Método no permitido&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>The <a class="reference internal" href="../incoming/incomingrequest.html#incomingrequest-is"><span class="std std-ref">$this-&gt;request-&gt;is()</span></a> method can be used since v7.3.0.
En versiones anteriores, es necesario utilizar
<code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(strtolower($this-&gt;request-&gt;getMethod())</span> <span class="pre">!==</span> <span class="pre">'publicación')</span></code>.</p>
</div>
</section>
<section id="cuando-el-enrutamiento-automatico-esta-habilitado">
<h4><a class="toc-backref" href="#id5" role="doc-backlink">Cuando el enrutamiento automático está habilitado</a><a class="headerlink" href="#cuando-el-enrutamiento-automatico-esta-habilitado" title="Link to this heading"></a></h4>
<ol class="arabic simple">
<li><p>Verifique el método de solicitud en el método del controlador antes de procesarlo.</p></li>
</ol>
<p>P.ej:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="k">if</span> <span class="p">(</span><span class="o">!</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">solicitud</span><span class="o">-&gt;</span><span class="na">is</span><span class="p">(</span><span class="s1">&#39;publicación&#39;</span><span class="p">))</span> <span class="p">{</span>
    <span class="k">return</span> <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">respuesta</span><span class="o">-&gt;</span><span class="na">setStatusCode</span><span class="p">(</span><span class="mi">405</span><span class="p">)</span><span class="o">-&gt;</span><span class="na">setBody</span><span class="p">(</span><span class="s1">&#39;Método no permitido&#39;</span><span class="p">);</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
</section>
<section id="configuracion-para-csrf">
<h3><a class="toc-backref" href="#id6" role="doc-backlink">Configuración para CSRF</a><a class="headerlink" href="#configuracion-para-csrf" title="Link to this heading"></a></h3>
<section id="metodos-de-proteccion-csrf">
<span id="csrf-protection-methods"></span><h4><a class="toc-backref" href="#id7" role="doc-backlink">Métodos de protección CSRF</a><a class="headerlink" href="#metodos-de-proteccion-csrf" title="Link to this heading"></a></h4>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>If you use <a class="reference internal" href="sessions.html"><span class="doc">Session</span></a>, be sure to use Session based
Protección CSRF. La protección CSRF basada en cookies no impedirá los ataques en el mismo sitio.
Ver
<cite>GHSA-5hm8-vh6r-2cjq&lt;https://github.com/Higgs(AI)/shield/security/advisories/GHSA-5hm8-vh6r-2cjq&gt;</cite> _
para detalles.</p>
</div>
<p>De forma predeterminada, se utiliza la protección CSRF basada en cookies. Es
<cite>Cookie de envío doble &lt;https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#double-submit-cookie&gt;</cite> _
en la hoja de referencia para la prevención de falsificación de solicitudes entre sitios de OWASP.</p>
<p>También puede utilizar la protección CSRF basada en sesiones. Es
<cite>Patrón de token de sincronizador &lt;https://cheatsheetseries.owasp.org/cheatsheets/Cross-Site_Request_Forgery_Prevention_Cheat_Sheet.html#synchronizer-token-pattern&gt;</cite> _.</p>
<p>Puede configurar el uso de la protección CSRF basada en sesión editando el siguiente valor del parámetro de configuración en
<strong>aplicación/Config/Security.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Security</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$csrfProtection</span> <span class="o">=</span> <span class="s1">&#39;session&#39;</span><span class="p">;</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="aleatorizacion-de-tokens">
<h4><a class="toc-backref" href="#id8" role="doc-backlink">Aleatorización de tokens</a><a class="headerlink" href="#aleatorizacion-de-tokens" title="Link to this heading"></a></h4>
<p>Para mitigar los ataques de compresión de canal lateral como <a class="reference external" href="https://en.wikipedia.org/wiki/BREACH">BREACH</a> y evitar que un atacante adivine los tokens CSRF, puede configurar la aleatorización de tokens (desactivada de forma predeterminada).</p>
<p>Si lo habilita, se agrega una máscara aleatoria al token y se usa para codificarlo.</p>
<p>Puede habilitarlo editando el siguiente valor del parámetro de configuración en
<strong>aplicación/Config/Security.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Security</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$tokenRandomize</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
</section>
<section id="regeneracion-de-tokens">
<h4><a class="toc-backref" href="#id9" role="doc-backlink">Regeneración de tokens</a><a class="headerlink" href="#regeneracion-de-tokens" title="Link to this heading"></a></h4>
<p>Los tokens pueden regenerarse en cada envío (predeterminado) o
se mantiene igual durante toda la vida de la sesión o cookie CSRF.</p>
<p>El valor por defecto
La regeneración de tokens proporciona una seguridad más estricta, pero puede resultar
en problemas de usabilidad ya que otros tokens dejan de ser válidos (hacia atrás/adelante)
navegación, múltiples pestañas/ventanas, acciones asincrónicas, etc.). Tú
puede alterar este comportamiento editando el siguiente valor del parámetro de configuración en
<strong>aplicación/Config/Security.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Security</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$regenerate</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>If you use Cookie based CSRF protection, and <a class="reference internal" href="../general/common_functions.html#redirect" title="redirect"><code class="xref php php-func docutils literal notranslate"><span class="pre">redirect()</span></code></a>
después del envío, debe llamar a <code class="docutils literal notranslate"><span class="pre">withCookie()</span></code> para enviar el archivo regenerado.
Galleta CSRF. Consulte <a class="reference internal" href="../outgoing/response.html#response-redirect"><span class="std std-ref">Redirect</span></a> para obtener más detalles.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>Since v7.2.3, you can regenerate CSRF token manually with the
Método <code class="docutils literal notranslate"><span class="pre">Seguridad::generateHash()</span></code>.</p>
</div>
</section>
<section id="redireccion-en-caso-de-error">
<span id="csrf-redirection-on-failure"></span><h4><a class="toc-backref" href="#id10" role="doc-backlink">Redirección en caso de error</a><a class="headerlink" href="#redireccion-en-caso-de-error" title="Link to this heading"></a></h4>
<p>Desde v7.3.0, cuando una solicitud no supera la verificación de validación CSRF,
lanzará una SecurityException de forma predeterminada,</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>In production environment, when you use HTML forms, it is recommended
para habilitar esta redirección para una mejor experiencia de usuario.</p>
</div>
<p>Si desea redirigir a la página anterior,
cambie el siguiente valor del parámetro de configuración en
<strong>aplicación/Config/Security.php</strong>:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Security</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="c1">// ...</span>

    <span class="k">public</span> <span class="nx">bool</span> <span class="nv">$redirect</span> <span class="o">=</span> <span class="k">true</span><span class="p">;</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cuando se redirige, se establece un mensaje flash de <code class="docutils literal notranslate"><span class="pre">error</span></code> que se puede mostrar al usuario final con el siguiente código en su vista:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?=</span> <span class="nx">session</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">obtener</span> <span class="nx">datos</span> <span class="nx">Flash</span><span class="p">(</span><span class="s1">&#39;error&#39;</span><span class="p">)</span><span class="cp">?&gt;</span>
</pre></div>
</div>
<p>Esto proporciona una experiencia mejor que simplemente fallar.</p>
<p>Incluso cuando el valor de redirección sea «verdadero», las llamadas AJAX no redireccionarán, pero generarán una excepción de seguridad.</p>
</section>
</section>
<section id="habilitar-la-proteccion-csrf">
<h3><a class="toc-backref" href="#id11" role="doc-backlink">Habilitar la protección CSRF</a><a class="headerlink" href="#habilitar-la-proteccion-csrf" title="Link to this heading"></a></h3>
<p>Puede habilitar la protección CSRF modificando su <strong>app/Config/Filters.php</strong>
y habilitando el filtro <cite>csrf</cite> globalmente:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$globals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="c1">// &#39;honeypot&#39;,</span>
            <span class="s1">&#39;csrf&#39;</span><span class="p">,</span>
        <span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Los URI seleccionados se pueden incluir en la lista blanca de la protección CSRF (por ejemplo, API
terminales que esperan contenido PUBLICADO externamente). Puedes agregar estos URI
agregándolos como excepciones en el filtro:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$globals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;csrf&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;except&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;api/record/save&#39;</span><span class="p">]],</span>
        <span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>También se admiten expresiones regulares (no distinguen entre mayúsculas y minúsculas):</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$globals</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;before&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="s1">&#39;csrf&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;except&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;api/record/[0-9]+&#39;</span><span class="p">]],</span>
        <span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>También es posible habilitar el filtro CSRF solo para métodos específicos:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$methods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;get&#39;</span>  <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;csrf&#39;</span><span class="p">],</span>
        <span class="s1">&#39;post&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;csrf&#39;</span><span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">$methods</span></code> filters, you should <a class="reference internal" href="../incoming/routing.html#use-defined-routes-only"><span class="std std-ref">disable Auto Routing (Legacy)</span></a>
porque <a class="reference internal" href="../incoming/routing.html#auto-routing-legacy"><span class="std std-ref">Enrutamiento automático (heredado)</span></a> permite que cualquier método HTTP acceda a un controlador.
Acceder al controlador con un método inesperado podría pasar por alto el filtro.</p>
</div>
</section>
<section id="formularios-html">
<h3><a class="toc-backref" href="#id12" role="doc-backlink">Formularios HTML</a><a class="headerlink" href="#formularios-html" title="Link to this heading"></a></h3>
<p>Si utiliza <a class="reference internal" href="../helpers/form_helper.html"><span class="doc">form helper</span></a>, entonces
<code class="xref py py-func docutils literal notranslate"><span class="pre">form_open()</span></code> insertará automáticamente un campo csrf oculto en
tus formularios.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>To use auto-generation of CSRF field, you need to turn CSRF filter on to the form page.
En la mayoría de los casos se solicita mediante el método <code class="docutils literal notranslate"><span class="pre">GET</span></code>.</p>
</div>
<p>Si no, entonces puedes usar el <code class="docutils literal notranslate"><span class="pre">csrf_token()</span></code> siempre disponible.
y funciones <code class="docutils literal notranslate"><span class="pre">csrf_hash()</span></code></p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;</span><span class="nx">input</span> <span class="nx">type</span><span class="o">=</span><span class="s2">&quot;hidden&quot;</span> <span class="nx">name</span><span class="o">=</span><span class="s2">&quot;&lt;?= csrf_token() ?&gt;&quot;</span> <span class="nx">value</span><span class="o">=</span><span class="s2">&quot;&lt;?= csrf_hash() ?&gt;&quot;</span> <span class="o">/&gt;</span>
</pre></div>
</div>
<p>Además, puede utilizar el método <code class="docutils literal notranslate"><span class="pre">csrf_field()</span></code> para generar este
campo de entrada oculto para usted:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="c1">// Genera:&lt;input type=&quot;hidden&quot; name=&quot;{csrf_token}&quot; value=&quot;{csrf_hash}&quot; /&gt;</span>
<span class="o">&lt;?=</span> <span class="nx">csrf_field</span><span class="p">()</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
<p>Al enviar una solicitud JSON, el token CSRF también se puede pasar como uno de los parámetros.
La siguiente forma de pasar el token CSRF es un encabezado Http especial cuyo nombre está disponible en
Función <code class="docutils literal notranslate"><span class="pre">csrf_header()</span></code>.</p>
<p>Además, puede utilizar el método <code class="docutils literal notranslate"><span class="pre">csrf_meta()</span></code> para generar este práctico
metaetiqueta para ti:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="c1">// Genera:&lt;meta name=&quot;{csrf_header}&quot; content=&quot;{csrf_hash}&quot; /&gt;</span>
<span class="o">&lt;?=</span> <span class="nx">csrf_meta</span><span class="p">()</span> <span class="cp">?&gt;</span>
</pre></div>
</div>
</section>
<section id="el-orden-de-los-tokens-enviados-por-los-usuarios">
<h3><a class="toc-backref" href="#id13" role="doc-backlink">El orden de los tokens enviados por los usuarios</a><a class="headerlink" href="#el-orden-de-los-tokens-enviados-por-los-usuarios" title="Link to this heading"></a></h3>
<p>El orden de verificación de la disponibilidad del token CSRF es el siguiente:</p>
<ol class="arabic simple">
<li><p>Matriz <code class="docutils literal notranslate"><span class="pre">$_POST</span></code></p></li>
<li><p>encabezado HTTP</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">php://input</span></code> (solicitud JSON): tenga en cuenta que este enfoque es el más lento ya que tenemos que decodificar JSON y luego volver a codificarlo.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">php://input</span></code> (cuerpo sin formato) - para solicitudes de tipo PUT, PATCH y DELETE</p></li>
</ol>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p><code class="docutils literal notranslate"><span class="pre">php://input</span></code> (raw body) is checked since v7.4.2.</p>
</div>
</section>
</section>
<section id="otros-metodos-utiles">
<h2><a class="toc-backref" href="#id14" role="doc-backlink">Otros métodos útiles</a><a class="headerlink" href="#otros-metodos-utiles" title="Link to this heading"></a></h2>
<p>Nunca necesitará utilizar directamente la mayoría de los métodos de la clase Seguridad. Los siguientes son métodos que
Puede resultarle útil que no esté relacionado con la protección CSRF.</p>
<section id="desinfectar-nombre-de-archivo">
<h3><a class="toc-backref" href="#id15" role="doc-backlink">desinfectar nombre de archivo()</a><a class="headerlink" href="#desinfectar-nombre-de-archivo" title="Link to this heading"></a></h3>
<p>Intenta desinfectar los nombres de archivos para evitar intentos de atravesar directorios y otras amenazas a la seguridad, lo cual es
particularmente útil para archivos que se proporcionaron a través de la entrada del usuario. El primer parámetro es la ruta a desinfectar.</p>
<p>Si es aceptable que la entrada del usuario incluya rutas relativas, por ejemplo, <strong>archivo/en/algunos/aprobado/carpeta.txt</strong>, puede configurar
el segundo parámetro opcional, <code class="docutils literal notranslate"><span class="pre">$relativePath</span></code> a <code class="docutils literal notranslate"><span class="pre">true</span></code>.</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$path</span> <span class="o">=</span> <span class="nv">$security</span><span class="o">-&gt;</span><span class="na">sanitizeFilename</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getVar</span><span class="p">(</span><span class="s1">&#39;filepath&#39;</span><span class="p">));</span>
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="publisher.html" class="btn btn-neutral float-left" title="Editor" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="sessions.html" class="btn btn-neutral float-right" title="Biblioteca de sesiones" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2012-2024 Jose Alexis Correa Valencia.
      <span class="lastupdated">Actualizado por última vez en jun 16, 2024.
      </span></p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>