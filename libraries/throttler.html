<!DOCTYPE html>
<html class="writer-html5" lang="es" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>acelerador &mdash; documentación de Higgs - 7.0.2</title>
      <link rel="stylesheet" type="text/css" href="../static/pygments.css?v=67a8c293" />
      <link rel="stylesheet" type="text/css" href="../static/css/citheme.css" />

  
    <link rel="canonical" href="https://higgs.com.co/libraries/throttler.html" />
  <!--[if lt IE 9]>
    <script src="../static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../static/jquery.js?v=5d32c60e"></script>
        <script src="../static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../static/documentation_options.js?v=e20d7d46"></script>
        <script src="../static/doctools.js?v=888ff710"></script>
        <script src="../static/sphinx_highlight.js?v=dc90522c"></script>
        <script src="../static/translations.js?v=efdbd0b9"></script>
        <script src="../static/js/citheme.js"></script>
        <script src="../static/js/carbon.js"></script>
    <script src="../static/js/theme.js"></script>
    <link rel="index" title="Índice" href="../genindex.html" />
    <link rel="search" title="Búsqueda" href="../search.html" />
    <link rel="next" title="Horarios y fechas" href="time.html" />
    <link rel="prev" title="Biblioteca de sesiones" href="sessions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html">
            
          </a>
              <div class="version">
                7.0
              </div>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Buscar documentos" aria-label="Buscar documentos" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
<li class="toctree-l1"><a class="reference internal" href="../intro/index.html">Bienvenido a Higgs (AI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../intro/hmvc.html">HMVC (Hierarchical Model-View-Controller)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../intro/psr.html">Cumplimiento de PSR</a></li>
<li class="toctree-l2"><a class="reference internal" href="../license.html">Acuerdo de licencia</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../installation/index.html">Instalación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_composer.html">Compositor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/installing_manual.html">Instalación manual</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/running.html">Ejecutando su aplicación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/troubleshooting.html">Solución de problemas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../changelogs/index.html">Registro de Cambios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/upgrading.html">Actualizaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../installation/repositories.html">Repositorios</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../tutorial/index.html">Cree su primera aplicación</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/static_pages.html">Páginas estáticas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/news_section.html">Sección de noticias</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/create_news_items.html">Crear noticias</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorial/conclusion.html">Conclusión</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../concepts/index.html">Descripción general del Higgs (AI)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../concepts/structure.html">Application Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/mvc.html">Modelos, vistas y controladores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/autoloader.html">Archivos de carga automática</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/services.html">Servicios</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/factories.html">Fábricas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/http.html">Trabajar con solicitudes HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../concepts/security.html">Pautas de seguridad</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../general/index.html">Temas generales</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/configuration.html">Configuración en Higgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/urls.html">URL de Higgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/helpers.html">Funciones auxiliares</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/common_functions.html">Funciones y constantes globales</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/logging.html">Información de registro</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/errors.html">Error Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/caching.html">Almacenamiento en caché de páginas web</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/ajax.html">Solicitudes AJAX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/modules.html">Módulos de código</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/managing_apps.html">Administrar sus aplicaciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/environments.html">Manejo de múltiples entornos</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../incoming/index.html">Controllers and Routing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../incoming/routing.html">Enrutamiento URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/controllers.html">Controladores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/filters.html">Filtros del controlador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/message.html">Mensajes HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/request.html">Solicitar clase</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/incomingrequest.html">IncomingRequest Class</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/content_negotiation.html">Content Negotiation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/methodspoofing.html">Suplantación de método HTTP</a></li>
<li class="toctree-l2"><a class="reference internal" href="../incoming/restful.html">Manejo de recursos RESTful</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../outgoing/index.html">Construyendo respuestas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/views.html">Puntos de vista</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_cells.html">Ver celdas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_renderer.html">Ver renderizador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_layouts.html">Ver diseños</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_parser.html">Ver analizador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/view_decorators.html">Ver decoradores</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/table.html">Clase de tabla HTML</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/response.html">HTTP Responses</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/api_responses.html">Rasgo de respuesta API</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/csp.html">Política de seguridad de contenidos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/localization.html">Localización</a></li>
<li class="toctree-l2"><a class="reference internal" href="../outgoing/alternative_php.html">Sintaxis PHP alternativa para ver archivos</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../database/index.html">Trabajar con bases de datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../database/examples.html">Inicio rápido: ejemplos de uso</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/configuration.html">Configuración de base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/connecting.html">Conexión a una base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/queries.html">Ejecución de consultas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/results.html">Generando resultados de consulta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/helpers.html">Funciones auxiliares de consulta</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/query_builder.html">Clase de generador de consultas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/transactions.html">Actas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/metadata.html">Obtener metadatos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/call_function.html">Llamadas a funciones personalizadas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/events.html">Eventos de base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../database/utilities.html">Utilidades de base de datos</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../models/index.html">Datos de modelado</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../models/model.html">Usando el modelo de Higgs</a></li>
<li class="toctree-l2"><a class="reference internal" href="../models/entities.html">Usando clases de entidad</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dbmgmt/index.html">Administrar bases de datos</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/forge.html">Manipulación de bases de datos con Database Forge</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/migration.html">Migraciones de bases de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/seeds.html">Siembra de base de datos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../dbmgmt/db_commands.html">Comandos de base de datos</a></li>
</ul>
</li>
</ul>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Referencia de la biblioteca</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="caching.html">Controlador de almacenamiento en caché</a></li>
<li class="toctree-l2"><a class="reference internal" href="cookies.html">Galletas</a></li>
<li class="toctree-l2"><a class="reference internal" href="curlrequest.html">Clase de solicitud CURL</a></li>
<li class="toctree-l2"><a class="reference internal" href="email.html">Clase de correo electrónico</a></li>
<li class="toctree-l2"><a class="reference internal" href="encryption.html">Servicio de cifrado</a></li>
<li class="toctree-l2"><a class="reference internal" href="files.html">Trabajar con archivos</a></li>
<li class="toctree-l2"><a class="reference internal" href="file_collections.html">Colecciones de archivos</a></li>
<li class="toctree-l2"><a class="reference internal" href="honeypot.html">clase de miel</a></li>
<li class="toctree-l2"><a class="reference internal" href="images.html">Clase de manipulación de imágenes</a></li>
<li class="toctree-l2"><a class="reference internal" href="pagination.html">Paginación</a></li>
<li class="toctree-l2"><a class="reference internal" href="publisher.html">Editor</a></li>
<li class="toctree-l2"><a class="reference internal" href="security.html">Seguridad</a></li>
<li class="toctree-l2"><a class="reference internal" href="sessions.html">Biblioteca de sesiones</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">acelerador</a></li>
<li class="toctree-l2"><a class="reference internal" href="time.html">Horarios y fechas</a></li>
<li class="toctree-l2"><a class="reference internal" href="typography.html">Tipografía</a></li>
<li class="toctree-l2"><a class="reference internal" href="uploaded_files.html">Trabajar con archivos cargados</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html">Creando instancias de URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#cadenas-uri">Cadenas URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#las-partes-de-uri">Las partes de URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#segmentos-uri">Segmentos URI</a></li>
<li class="toctree-l2"><a class="reference internal" href="uri.html#deshabilitar-el-lanzamiento-de-excepciones">Deshabilitar el lanzamiento de excepciones</a></li>
<li class="toctree-l2"><a class="reference internal" href="user_agent.html">Clase de agente de usuario</a></li>
<li class="toctree-l2"><a class="reference internal" href="validation.html">Validation</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../helpers/index.html">Ayudantes</a><ul class="simple">
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../testing/index.html">Pruebas</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../testing/overview.html">Getting Started</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/database.html">Database</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/fabricator.html">Generating Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/controllers.html">Controller Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/feature.html">HTTP Testing</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/response.html">Respuestas de prueba</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/mocking.html">Mocking</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/benchmark.html">Evaluación comparativa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../testing/debugging.html">Depurando su aplicación</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../cli/index.html">Uso de la línea de comando</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_overview.html">Descripción general de la CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_controllers.html">Ejecución de controladores a través de CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/spark_commands.html">Comandos de chispa</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_commands.html">Crear comandos Spark</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_generators.html">Generadores CLI</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_library.html">CLI Library</a></li>
<li class="toctree-l2"><a class="reference internal" href="../cli/cli_request.html">Clase de solicitud CLI</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../extending/index.html">Higgs extendido</a><ul>
<li class="toctree-l2"><a class="reference internal" href="../extending/core_classes.html">Crear clases de sistema central</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/common.html">Reemplazo de funciones comunes</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/events.html">Eventos</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/basecontroller.html">Ampliación del controlador</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/authentication.html">Autenticación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/composer_packages.html">Crear paquetes de compositor</a></li>
<li class="toctree-l2"><a class="reference internal" href="../extending/contributing.html">Contribuyendo al Higgs</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="official_packages.html">Paquetes Oficiales</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Higgs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">Referencia de la biblioteca</a></li>
      <li class="breadcrumb-item active">acelerador</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="acelerador">
<h1>acelerador<a class="headerlink" href="#acelerador" title="Link to this heading"></a></h1>
<nav class="contents local" id="contenido">
<ul class="simple">
<li><p><a class="reference internal" href="#descripcion-general" id="id1">Descripción general</a></p></li>
<li><p><a class="reference internal" href="#limitacion-de-tasa" id="id2">Limitación de tasa</a></p>
<ul>
<li><p><a class="reference internal" href="#el-codigo" id="id3">El código</a></p></li>
<li><p><a class="reference internal" href="#aplicar-el-filtro" id="id4">Aplicar el filtro</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#referencia-de-clase" id="id5">Referencia de clase</a></p></li>
</ul>
</nav>
<p>La clase Throttler proporciona una forma muy sencilla de limitar la realización de una actividad a un determinado número de intentos.
dentro de un período de tiempo determinado. Esto se utiliza con mayor frecuencia para limitar la velocidad de las API o restringir el número
de intentos que un usuario puede realizar contra un formulario para ayudar a prevenir ataques de fuerza bruta. La clase en sí se puede utilizar.
para cualquier cosa que necesite acelerar en función de acciones dentro de un intervalo de tiempo establecido.</p>
<section id="descripcion-general">
<h2><a class="toc-backref" href="#id1" role="doc-backlink">Descripción general</a><a class="headerlink" href="#descripcion-general" title="Link to this heading"></a></h2>
<p>El Throttler implementa una versión simplificada del <cite>Token Bucket&lt;https://en.wikipedia.org/wiki/Token_bucket&gt;</cite> _
algoritmo. Básicamente, esto trata cada acción que desea como un depósito. Cuando llamas al método <code class="docutils literal notranslate"><span class="pre">check()</span></code>,
usted le dice qué tan grande es el depósito, cuántas fichas puede contener y el intervalo de tiempo. Cada llamada <code class="docutils literal notranslate"><span class="pre">check()</span></code> utiliza
1 de los tokens disponibles, por defecto. Veamos un ejemplo para aclarar esto.</p>
<p>Digamos que queremos que ocurra una acción una vez por segundo. La primera llamada al Throttler sería similar a la siguiente.
El primer parámetro es el nombre del depósito, el segundo parámetro, la cantidad de tokens que contiene el depósito y
el tercero es la cantidad de tiempo que tarda el balde en volver a llenarse:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="nv">$throttler</span> <span class="o">=</span> <span class="nx">\Config\Services</span><span class="o">::</span><span class="na">throttler</span><span class="p">();</span>
<span class="nv">$throttler</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">(</span><span class="nv">$name</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="nx">MINUTE</span><span class="p">);</span>
</pre></div>
</div>
<p>Aquí estamos usando una de las <a class="reference internal" href="../general/common_functions.html"><span class="doc">constantes globales</span></a>  por el momento, para hacerlo un poco
más legible. Esto dice que el depósito permite 60 acciones por minuto, o 1 acción por segundo.</p>
<p>Digamos que un script de terceros intentaba acceder a una URL repetidamente. Al principio, podría utilizar los 60
de esos tokens en menos de un segundo. Sin embargo, después de eso, el Throttler solo permitiría una acción por segundo.
potencialmente ralentizando las solicitudes lo suficiente como para que el ataque ya no valga la pena.</p>
<div class="admonition note">
<p class="admonition-title">Nota</p>
<p>For the Throttler class to work, the Cache library must be set up to use a handler other than dummy.
Para obtener el mejor rendimiento, se recomienda una caché en memoria, como Redis o Memcached.</p>
</div>
</section>
<section id="limitacion-de-tasa">
<h2><a class="toc-backref" href="#id2" role="doc-backlink">Limitación de tasa</a><a class="headerlink" href="#limitacion-de-tasa" title="Link to this heading"></a></h2>
<p>La clase Throttler no limita la velocidad ni solicita aceleración por sí sola, pero es la clave para hacer
una obra. Un ejemplo <a class="reference internal" href="../incoming/filters.html"><span class="doc">Filtro</span></a>  se proporciona que implementa un límite de tasa muy simple en
una solicitud por segundo por dirección IP. Aquí explicaremos cómo funciona y cómo puede configurarlo y
comience a usarlo en su aplicación.</p>
<section id="el-codigo">
<h3><a class="toc-backref" href="#id3" role="doc-backlink">El código</a><a class="headerlink" href="#el-codigo" title="Link to this heading"></a></h3>
<p>Puedes crear tu propio filtro Throttler, en <strong>app/Filters/Throttle.php</strong>,
en la línea de:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">App\Filters</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Filters\FilterInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Higgs\HTTP\RequestInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Higgs\HTTP\ResponseInterface</span><span class="p">;</span>
<span class="k">use</span> <span class="nx">Config\Services</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Throttle</span> <span class="k">implements</span> <span class="nx">FilterInterface</span>
<span class="p">{</span>
    <span class="sd">/**</span>
<span class="sd">     * This is a demo implementation of using the Throttler class</span>
<span class="sd">     * to implement rate limiting for your application.</span>
<span class="sd">     *</span>
<span class="sd">     * @param array|null $arguments</span>
<span class="sd">     *</span>
<span class="sd">     * @return mixed</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">before</span><span class="p">(</span><span class="nx">RequestInterface</span> <span class="nv">$request</span><span class="p">,</span> <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$throttler</span> <span class="o">=</span> <span class="nx">Services</span><span class="o">::</span><span class="na">throttler</span><span class="p">();</span>

        <span class="c1">// Restrict an IP address to no more than 1 request</span>
        <span class="c1">// per second across the entire site.</span>
        <span class="k">if</span> <span class="p">(</span><span class="nv">$throttler</span><span class="o">-&gt;</span><span class="na">check</span><span class="p">(</span><span class="nb">md5</span><span class="p">(</span><span class="nv">$request</span><span class="o">-&gt;</span><span class="na">getIPAddress</span><span class="p">()),</span> <span class="mi">60</span><span class="p">,</span> <span class="nx">MINUTE</span><span class="p">)</span> <span class="o">===</span> <span class="k">false</span><span class="p">)</span> <span class="p">{</span>
            <span class="k">return</span> <span class="nx">Services</span><span class="o">::</span><span class="na">response</span><span class="p">()</span><span class="o">-&gt;</span><span class="na">setStatusCode</span><span class="p">(</span><span class="mi">429</span><span class="p">);</span>
        <span class="p">}</span>
    <span class="p">}</span>

    <span class="sd">/**</span>
<span class="sd">     * We don&#39;t have anything to do here.</span>
<span class="sd">     *</span>
<span class="sd">     * @param array|null $arguments</span>
<span class="sd">     *</span>
<span class="sd">     * @return mixed</span>
<span class="sd">     */</span>
    <span class="k">public</span> <span class="k">function</span> <span class="nf">after</span><span class="p">(</span><span class="nx">RequestInterface</span> <span class="nv">$request</span><span class="p">,</span> <span class="nx">ResponseInterface</span> <span class="nv">$response</span><span class="p">,</span> <span class="nv">$arguments</span> <span class="o">=</span> <span class="k">null</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="c1">// ...</span>
    <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<p>Cuando se ejecuta, este método primero toma una instancia del acelerador. A continuación, utiliza la dirección IP como nombre del depósito,
y establece cosas para limitarlas a una solicitud por segundo. Si el acelerador rechaza la verificación y devuelve falso,
luego devolvemos una respuesta con el código de estado establecido en 429 - Demasiados intentos y la ejecución del script finaliza
antes de que llegue al controlador. Este ejemplo acelerará en función de una única dirección IP en todas las solicitudes.
realizados al sitio, no por página.</p>
</section>
<section id="aplicar-el-filtro">
<h3><a class="toc-backref" href="#id4" role="doc-backlink">Aplicar el filtro</a><a class="headerlink" href="#aplicar-el-filtro" title="Link to this heading"></a></h3>
<p>No necesariamente necesitamos limitar cada página del sitio. Para muchas aplicaciones web, esto tiene más sentido.
para aplicarse solo a solicitudes POST, aunque es posible que las API deseen limitar cada solicitud realizada por un usuario. Con el fin de aplicar
esto para las solicitudes entrantes, debe editar <strong>app/Config/Filters.php</strong> y primero agregar un alias al
filtrar:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$aliases</span> <span class="o">=</span> <span class="p">[</span>
        <span class="c1">// ...</span>
        <span class="s1">&#39;throttle&#39;</span> <span class="o">=&gt;</span> <span class="nx">\App\Filters\Throttle</span><span class="o">::</span><span class="na">class</span><span class="p">,</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<p>A continuación, lo asignamos a todas las solicitudes POST realizadas en el sitio:</p>
<div class="highlight-html+php notranslate"><div class="highlight"><pre><span></span><span class="o">&lt;?</span><span class="nx">php</span>

<span class="k">namespace</span> <span class="nx">Config</span><span class="p">;</span>

<span class="k">use</span> <span class="nx">Higgs\Config\BaseConfig</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">Filters</span> <span class="k">extends</span> <span class="nx">BaseConfig</span>
<span class="p">{</span>
    <span class="k">public</span> <span class="nv">$methods</span> <span class="o">=</span> <span class="p">[</span>
        <span class="s1">&#39;post&#39;</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="s1">&#39;throttle&#39;</span><span class="p">],</span>
    <span class="p">];</span>

    <span class="c1">// ...</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Advertencia</p>
<p>If you use <code class="docutils literal notranslate"><span class="pre">$methods</span></code> filters, you should <a class="reference internal" href="../incoming/routing.html#use-defined-routes-only"><span class="std std-ref">disable Auto Routing (Legacy)</span></a>
porque <a class="reference internal" href="../incoming/routing.html#auto-routing-legacy"><span class="std std-ref">Enrutamiento automático (heredado)</span></a> permite que cualquier método HTTP acceda a un controlador.
Acceder al controlador con un método inesperado podría pasar por alto el filtro.</p>
</div>
<p>Y eso es todo. Ahora todas las solicitudes POST realizadas en el sitio tendrán que tener una tarifa limitada.</p>
</section>
</section>
<section id="referencia-de-clase">
<h2><a class="toc-backref" href="#id5" role="doc-backlink">Referencia de clase</a><a class="headerlink" href="#referencia-de-clase" title="Link to this heading"></a></h2>
<dl class="php method">
<dt class="sig sig-object php" id="check">
<span class="sig-name descname"><span class="pre">check</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">string</span> <span class="pre">$key</span></em>, <em class="sig-param"><span class="pre">int</span> <span class="pre">$capacity</span></em>, <em class="sig-param"><span class="pre">int</span> <span class="pre">$seconds</span></em><span class="optional">[</span>, <em class="sig-param"><span class="pre">int</span> <span class="pre">$cost</span> <span class="pre">=</span> <span class="pre">1</span></em><span class="optional">]</span><span class="sig-paren">)</span><a class="headerlink" href="#check" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parámetros<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – el nombre del depósito</p></li>
<li><p><strong>$capacidad</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – la cantidad de tokens que contiene el depósito</p></li>
<li><p><strong>$segundos</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – el número de segundos que tarda un depósito en llenarse por completo</p></li>
<li><p><strong>$cost</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">int</span></code></span>) – La cantidad de tokens que se gastan en esta acción</p></li>
</ul>
</dd>
<dt class="field-even">Devuelve<span class="colon">:</span></dt>
<dd class="field-even"><p>verdadero si se puede realizar la acción, falso si no</p>
</dd>
<dt class="field-odd">Tipo del valor devuelto<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">booleano</span></code></span></p>
</dd>
</dl>
<p>Comprueba si quedan fichas dentro del depósito o si hay demasiadas.
sido utilizado dentro del límite de tiempo asignado. Durante cada comprobación los tokens disponibles
se reducen en $cost si tienen éxito.</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="getTokentime">
<span class="sig-name descname"><span class="pre">getTokentime</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#getTokentime" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Devuelve<span class="colon">:</span></dt>
<dd class="field-odd"><p>el número de segundos hasta que otro token esté disponible.</p>
</dd>
<dt class="field-even">Tipo del valor devuelto<span class="colon">:</span></dt>
<dd class="field-even"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">entero</span></code></span></p>
</dd>
</dl>
<p>Después de ejecutar <code class="docutils literal notranslate"><span class="pre">check()</span></code> y devolver falso, se puede utilizar este método
para determinar el tiempo hasta que un nuevo token esté disponible y la acción pueda ser
intentó de nuevo. En este caso, el tiempo de espera mínimo obligatorio es de un segundo.</p>
</dd></dl>

<dl class="php method">
<dt class="sig sig-object php" id="remove">
<span class="sig-name descname"><span class="pre">remove</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="pre">string</span> <span class="pre">$key</span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">self</span></span></span><a class="headerlink" href="#remove" title="Link to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parámetros<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>$key</strong> (<span><code class="xref php php-obj docutils literal notranslate"><span class="pre">string</span></code></span>) – el nombre del depósito</p></li>
</ul>
</dd>
<dt class="field-even">Devuelve<span class="colon">:</span></dt>
<dd class="field-even"><p>$esto</p>
</dd>
<dt class="field-odd">Tipo del valor devuelto<span class="colon">:</span></dt>
<dd class="field-odd"><p><span><code class="xref php php-obj docutils literal notranslate"><span class="pre">yo</span></code></span></p>
</dd>
</dl>
<p>Elimina y reinicia el cubo.
No fallará si el depósito no existe.</p>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Pie de página">
        <a href="sessions.html" class="btn btn-neutral float-left" title="Biblioteca de sesiones" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Anterior</a>
        <a href="time.html" class="btn btn-neutral float-right" title="Horarios y fechas" accesskey="n" rel="next">Siguiente <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Derechos de autor 2012-2025 Jose Alexis Correa Valencia.
      <span class="lastupdated">Actualizado por última vez en feb 16, 2025.
      </span></p>
  </div>

  Compilado con <a href="https://www.sphinx-doc.org/">Sphinx</a> usando un
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">tema</a>
    proporcionado por <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(false);
      });
  </script> 

</body>
</html>